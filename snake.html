<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Space Snake — 10x10</title>
  <style>
    :root{
      --ui-bg: rgba(2,6,23,0.8);
      --accent: #7be0ff;
      --accent-2: #b28cff;
      --glass: rgba(255,255,255,0.06);
      --glass-2: rgba(255,255,255,0.02);
      --panel: rgba(255,255,255,0.04);
    }
    html,body{height:100%;margin:0;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial;color:#eaf6ff}
    body{
      display:flex;align-items:center;justify-content:center;
      background: radial-gradient(ellipse at 20% 10%, rgba(123,224,255,0.06), transparent 8%),
                  radial-gradient(ellipse at 80% 90%, rgba(178,140,255,0.04), transparent 10%),
                  linear-gradient(180deg,#001026 0%, #03061a 100%);
      overflow:hidden;
    }
    .container{
      width:880px;max-width:95vw;display:grid;grid-template-columns:420px 1fr;gap:24px;align-items:start;padding:28px;border-radius:18px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));box-shadow:0 10px 30px rgba(0,0,0,0.6);
      backdrop-filter: blur(6px);
    }
    .viewport{
      background: radial-gradient(circle at 20% 10%, rgba(255,255,255,0.03), transparent 10%),
                  linear-gradient(180deg,#071120 0%, #000814 100%);
      border-radius:12px;padding:16px;display:flex;flex-direction:column;align-items:center;justify-content:center;position:relative;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.02), 0 8px 24px rgba(2,4,10,0.6);
    }
    .game-canvas{width:400px;height:400px;background:transparent;border-radius:8px;display:block}
    .starfield-canvas{position:absolute;left:0;top:0;width:100%;height:100%;border-radius:12px;pointer-events:none}

    .panel{padding:14px;border-radius:12px;background:linear-gradient(180deg,var(--panel),transparent);box-shadow: inset 0 1px 0 rgba(255,255,255,0.02)}
    .controls{display:flex;gap:12px;align-items:center;margin-top:12px}
    .btn{background:linear-gradient(180deg,#0b2340,#041326);border:1px solid rgba(255,255,255,0.04);padding:8px 12px;border-radius:10px;color:var(--accent);cursor:pointer;font-weight:600}
    .btn.secondary{background:transparent;color:#cfefff;border:1px solid rgba(255,255,255,0.03)}
    .info{display:flex;flex-direction:column;gap:10px}
    .stats{display:flex;gap:12px;align-items:center}
    .stat{padding:8px;border-radius:10px;background:var(--glass);min-width:88px;text-align:center}
    label{font-size:13px;color:#bfeaff}

    .right{display:flex;flex-direction:column;gap:12px}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:#b9e9ffcc}
    .slider-row{display:flex;gap:12px;align-items:center}
    input[type=range]{accent-color:var(--accent);width:140px}
    .legend{font-size:13px;color:#9fdcff}
    footer.small{font-size:12px;opacity:0.7}

    .small-note{font-size:13px;color:#bfeaffcc}
    .instructions{font-size:13px;color:#9ed7ff;margin-top:6px}

    /* responsive small screens */
    @media (max-width:760px){
      .container{grid-template-columns:1fr;}
      .game-canvas{width:300px;height:300px}
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="viewport panel">
      <canvas id="starfield" class="starfield-canvas"></canvas>
      <canvas id="game" class="game-canvas" width="400" height="400" tabindex="0"></canvas>

      <div class="controls">
        <button id="startBtn" class="btn">Start</button>
        <button id="pauseBtn" class="btn secondary">Pause</button>
        <button id="resetBtn" class="btn secondary">Reset</button>

        <div style="margin-left:8px"></div>
        <div class="small-note">Use arrow keys to steer</div>
      </div>

      <div class="instructions" style="text-align:center;max-width:360px">
        Theme: <strong>Outer Space</strong> — collect cosmic candies to grow your craft. Grid: <strong>10 × 10</strong>.
      </div>
    </div>

    <div class="right">
      <div class="panel">
        <h1>Space Snake</h1>
        <p class="lead">Eat cosmic candy to grow. Avoid hitting walls or your own tail.</p>
        <div class="info" style="margin-top:12px">
          <div class="stats">
            <div class="stat">Score<br><strong id="score">0</strong></div>
            <div class="stat">High Score<br><strong id="highScore">0</strong></div>
            <div class="stat">Length<br><strong id="length">1</strong></div>
          </div>

          <div style="margin-top:12px">
            <label for="speedRange">Speed (moves per second)</label>
            <div class="slider-row">
              <input id="speedRange" type="range" min="1" max="10" value="5">
              <div class="legend"><span id="speedVal">5</span> m/s</div>
            </div>
          </div>

          <div style="margin-top:12px">
            <label>Game Mode</label>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="classic" class="btn secondary">Classic (walls kill)</button>
              <button id="wrap" class="btn">Wrap (tunnel edges)</button>
            </div>
          </div>

          <div style="margin-top:12px">
            <label>Theme Options</label>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="neon" class="btn">Neon</button>
              <button id="retro" class="btn secondary">Retro</button>
            </div>
          </div>

        </div>
      </div>

      <div class="panel" style="padding-top:12px">
        <h3 style="margin:0 0 8px 0">How to play</h3>
        <ol style="margin:0 0 8px 16px;color:#bfeaff">
          <li>Start the game and use the arrow keys to move.</li>
          <li>Eat candy to grow and gain score.</li>
          <li>Avoid colliding with your tail (or walls in Classic).</li>
        </ol>
        <div class="small-note">High score is stored locally in your browser.</div>
        <div style="height:12px"></div>
        <footer class="small">Made with ✨ in a single HTML file — grid: 10×10 — outer space theme.</footer>
      </div>
    </div>
  </div>

  <script>
  (function(){
    // Config
    const COLS = 10;
    const ROWS = 10;
    const canvas = document.getElementById('game');
    const ctx = canvas.getContext('2d');
    const starCanvas = document.getElementById('starfield');
    const sctx = starCanvas.getContext('2d');
    const startBtn = document.getElementById('startBtn');
    const pauseBtn = document.getElementById('pauseBtn');
    const resetBtn = document.getElementById('resetBtn');
    const speedRange = document.getElementById('speedRange');
    const speedVal = document.getElementById('speedVal');
    const scoreEl = document.getElementById('score');
    const highScoreEl = document.getElementById('highScore');
    const lengthEl = document.getElementById('length');
    const classicBtn = document.getElementById('classic');
    const wrapBtn = document.getElementById('wrap');
    const neonBtn = document.getElementById('neon');
    const retroBtn = document.getElementById('retro');

    // Responsive canvas sizing
    function fitCanvases(){
      // game canvas is square; choose physical pixel size based on css size
      const rect = canvas.getBoundingClientRect();
      const size = Math.min(rect.width, rect.height);
      canvas.width = size;
      canvas.height = size;
      starCanvas.width = rect.width;
      starCanvas.height = rect.height;
      drawStarfield();
    }
    window.addEventListener('resize', fitCanvases);
    fitCanvases();

    // Starfield background
    function drawStarfield(){
      const w = starCanvas.width, h = starCanvas.height;
      sctx.clearRect(0,0,w,h);
      const count = Math.round((w*h)/15000);
      for(let i=0;i<count;i++){
        const x = Math.random()*w;
        const y = Math.random()*h;
        const r = Math.random()*1.8;
        const g = sctx.createRadialGradient(x,y,0,x,y,r*6);
        g.addColorStop(0, 'rgba(255,255,255,' + (0.6*Math.random()+0.2) + ')');
        g.addColorStop(1, 'rgba(255,255,255,0)');
        sctx.fillStyle = g;
        sctx.fillRect(x-r*6,y-r*6,r*12,r*12);
      }
      // faint nebula
      const grad = sctx.createLinearGradient(0,0,w,h);
      grad.addColorStop(0, 'rgba(123,224,255,0.02)');
      grad.addColorStop(1, 'rgba(178,140,255,0.015)');
      sctx.fillStyle = grad;
      sctx.fillRect(0,0,w,h);
    }

    // Game state
    let cellSize = () => Math.floor(canvas.width / COLS);
    let snake = [{x:4,y:5}]; // array of segments, head first
    let dir = {x:1,y:0};
    let nextDir = {x:1,y:0};
    let candy = null;
    let running = false;
    let wrap = false; // wrap mode
    let score = 0;
    let highScore = Number(localStorage.getItem('spaceSnakeHigh')||0);
    highScoreEl.textContent = highScore;
    let speed = Number(speedRange.value); // moves per second
    let lastMoveTime = 0;
    let moveInterval = 1000 / speed; // ms per move
    let animationId = null;

    function placeCandy(){
      const empty = [];
      for(let x=0;x<COLS;x++) for(let y=0;y<ROWS;y++){
        if (!snake.some(s => s.x===x && s.y===y)) empty.push({x,y});
      }
      if (empty.length===0){ candy = null; return; }
      candy = empty[Math.floor(Math.random()*empty.length)];
    }

    function resetGame(){
      snake = [{x:4,y:5}]; dir = {x:1,y:0}; nextDir = {x:1,y:0}; score=0; updateStats(); placeCandy(); running=false; lastMoveTime=0; draw();
    }

    function updateStats(){
      scoreEl.textContent = score;
      lengthEl.textContent = snake.length;
      highScoreEl.textContent = highScore;
    }

    function setSpeed(v){
      speed = v; moveInterval = 1000 / speed; speedVal.textContent = v;
    }
    setSpeed(speedRange.value);

    speedRange.addEventListener('input', e=>{
      setSpeed(Number(e.target.value));
    });

    document.addEventListener('visibilitychange', ()=>{
      if (document.hidden && running){ pause(); }
    });

    function step(){
      // move snake by 1 cell
      dir = nextDir;
      const head = {x: snake[0].x + dir.x, y: snake[0].y + dir.y};
      if (wrap){
        if (head.x < 0) head.x = COLS-1;
        if (head.x >= COLS) head.x = 0;
        if (head.y < 0) head.y = ROWS-1;
        if (head.y >= ROWS) head.y = 0;
      } else {
        if (head.x < 0 || head.x >= COLS || head.y <0 || head.y>=ROWS){ gameOver(); return; }
      }
      if (snake.some(s=>s.x===head.x && s.y===head.y)) { gameOver(); return; }
      snake.unshift(head);
      // eat
      if (candy && head.x===candy.x && head.y===candy.y){
        score += 10;
        if (score>highScore){ highScore = score; localStorage.setItem('spaceSnakeHigh', highScore); }
        placeCandy();
      } else {
        snake.pop();
      }
      updateStats();
    }

    function gameOver(){
      running = false;
      updateStats();
      draw();
      // small flash
      ctx.save();
      ctx.fillStyle = 'rgba(255,20,60,0.14)';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.restore();
      setTimeout(()=>{
        // do nothing for now
      },300);
    }

    function draw(){
      const w = canvas.width, h = canvas.height;
      const cs = cellSize();
      // background grid
      ctx.clearRect(0,0,w,h);
      // soft background
      const bg = ctx.createLinearGradient(0,0,w,h);
      bg.addColorStop(0,'#00172b'); bg.addColorStop(1,'#000814');
      ctx.fillStyle = bg; ctx.fillRect(0,0,w,h);
      // subtle grid lines
      ctx.strokeStyle = 'rgba(255,255,255,0.03)'; ctx.lineWidth=1;
      for(let i=0;i<=COLS;i++){ ctx.beginPath(); ctx.moveTo(i*cs,0); ctx.lineTo(i*cs,h); ctx.stroke(); }
      for(let j=0;j<=ROWS;j++){ ctx.beginPath(); ctx.moveTo(0,j*cs); ctx.lineTo(w,j*cs); ctx.stroke(); }

      // draw candy (cosmic)
      if (candy){
        const cx = candy.x*cs + cs/2; const cy = candy.y*cs + cs/2; const r = cs*0.28;
        // glow
        const g = ctx.createRadialGradient(cx,cy,0,cx,cy,r*2);
        g.addColorStop(0,'rgba(255,200,60,0.95)');
        g.addColorStop(0.4,'rgba(255,100,230,0.65)');
        g.addColorStop(1,'rgba(255,100,230,0)');
        ctx.fillStyle = g; ctx.beginPath(); ctx.arc(cx,cy,r*1.3,0,Math.PI*2); ctx.fill();
        // candy core (a small planet-like candy)
        ctx.fillStyle = 'radial-gradient placeholder';
        ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2); ctx.fillStyle='#ffd36b'; ctx.fill();
        // ring
        ctx.beginPath(); ctx.ellipse(cx,cy,r*1.4,r*0.5, Math.PI/5, 0, Math.PI*2);
        ctx.strokeStyle='rgba(255,255,255,0.12)'; ctx.lineWidth=2; ctx.stroke();
      }

      // draw snake
      for(let i=snake.length-1;i>=0;i--){
        const s = snake[i];
        const x = s.x*cs, y = s.y*cs;
        // head is glowing
        if (i===0){
          ctx.fillStyle = '#7be0ff';
          roundRect(ctx,x+2,y+2,cs-4,cs-4,6,true,false);
          // engine glow
          ctx.fillStyle = 'rgba(123,224,255,0.16)'; ctx.beginPath(); ctx.arc(x+cs/2,y+cs/2,cs*0.38,0,Math.PI*2); ctx.fill();
        } else {
          // body gradient
          const t = i/snake.length;
          const gcol = `rgba(${Math.round(120+(1-t)*80)},${Math.round(200-(t*120))},${Math.round(255-(t*50))},1)`;
          ctx.fillStyle = gcol;
          roundRect(ctx,x+3,y+3,cs-6,cs-6,4,true,false);
        }
      }

      // overlay HUD
      ctx.fillStyle = 'rgba(255,255,255,0.02)'; ctx.fillRect(0,0,w,44);
      ctx.fillStyle = '#bfeaff'; ctx.font = '600 14px Inter, Arial'; ctx.fillText('Score: '+score, 12, 26);
      ctx.fillText('Speed: '+speed+' m/s', w-120, 26);

      // if not running show play hint
      if(!running){ ctx.fillStyle = 'rgba(0,0,0,0.35)'; ctx.fillRect(0, h-48, w, 48); ctx.fillStyle='#bfeaff'; ctx.font='600 12px Inter, Arial'; ctx.fillText('Press Start or use Arrow keys to begin', 12, h-22); }
    }

    function roundRect(ctx,x,y,w,h,r,fill,stroke){
      if (typeof r === 'undefined') r = 5;
      ctx.beginPath(); ctx.moveTo(x+r,y); ctx.arcTo(x+w,y,x+w,y+h,r); ctx.arcTo(x+w,y+h,x,y+h,r); ctx.arcTo(x,y+h,x,y,r); ctx.arcTo(x,y,x+w,y,r); ctx.closePath();
      if (fill) ctx.fill(); if (stroke) ctx.stroke();
    }

    // Input handling
    window.addEventListener('keydown', e=>{
      if (['ArrowUp','ArrowDown','ArrowLeft','ArrowRight'].includes(e.key)) e.preventDefault();
      const k = e.key;
      const map = {ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};
      if (map[k]){
        const nd = map[k];
        // prevent reversing
        if (snake.length>1 && nd.x === -dir.x && nd.y === -dir.y) return;
        nextDir = nd;
        // start game on first keypress
        if (!running){ start(); }
      }
    });

    // Buttons
    startBtn.addEventListener('click', ()=>{ if(!running) start(); });
    pauseBtn.addEventListener('click', ()=>{ if(running) pause(); else start(); });
    resetBtn.addEventListener('click', ()=>{ resetGame(); });

    classicBtn.addEventListener('click', ()=>{ wrap=false; classicBtn.classList.add('btn'); classicBtn.classList.remove('secondary'); wrapBtn.classList.remove('btn'); wrapBtn.classList.add('secondary'); });
    wrapBtn.addEventListener('click', ()=>{ wrap=true; wrapBtn.classList.add('btn'); wrapBtn.classList.remove('secondary'); classicBtn.classList.remove('btn'); classicBtn.classList.add('secondary'); });
    neonBtn.addEventListener('click', ()=>{ document.documentElement.style.setProperty('--accent','#7be0ff'); document.documentElement.style.setProperty('--accent-2','#b28cff'); });
    retroBtn.addEventListener('click', ()=>{ document.documentElement.style.setProperty('--accent','#ffd36b'); document.documentElement.style.setProperty('--accent-2','#ff8fb3'); });

    function start(){ if (snake.length===0) resetGame(); running = true; lastMoveTime = performance.now(); animate(); }
    function pause(){ running = false; cancelAnimationFrame(animationId); }

    function animate(now){
      animationId = requestAnimationFrame(animate);
      if (!lastMoveTime) lastMoveTime = now;
      const elapsed = now - lastMoveTime;
      if (elapsed >= moveInterval){
        lastMoveTime = now - (elapsed % moveInterval);
        step();
      }
      draw();
    }

    // Update move interval when speed changes
    setInterval(()=>{ moveInterval = 1000 / speed; },100);

    // initial placement
    placeCandy(); updateStats(); draw();

    // focus for keyboard on canvas
    canvas.addEventListener('click', ()=>canvas.focus());

    // give user a gentle starting high score if none
    if (highScore===0){ highScore = Number(localStorage.getItem('spaceSnakeHigh')||0); }
  })();
  </script>
</body>
</html>
